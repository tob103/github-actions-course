This code has been edited on this branch. 
