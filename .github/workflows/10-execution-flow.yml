name: 10 - Controlling the Execution Flow
on:
  workflow_dispatch:
    inputs:
      pass-unit-tests:
        type: boolean
        default: false
        description: "Set to true to pass unit tests"

jobs:
  lint-build:
    runs-on: ubuntu-latest
    steps:
     - name: Lint and build
       run: echo "Linting and building project"

  unit-tests:
    continue-on-error: true
    runs-on: ubuntu-latest
    steps:
     - name: Run unit tests
       run: echo "Running unit tests..."

     - name: Failing unit tests
       if: inputs.pass-unit-tests == false
       run: exit 1

  deploy-nonprod:
    runs-on: ubuntu-latest
    needs: [lint-build, unit-tests]
    steps:
     - name: Deploy to nonprod
       run: echo "Deploying to nonprod"


  e2e-tests:
    runs-on: ubuntu-latest
    needs: [deploy-nonprod]
    steps:
     - name: Run e2e tests
       run: echo "Running e2e tests..."


  load-tests:
   runs-on: ubuntu-latest
   needs: [deploy-nonprod]
   steps:
    - name: Run load tests
      run: echo "Running load tests..."



  deploy-prod:
    runs-on: ubuntu-latest
    needs: [e2e-tests, load-tests]
    steps:
     - name: Deploy to prod
       run: echo "Deploying to prod"